<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#f0f9ff">
    
    <title>Jasper P3 ç›´å¼æŒ‘æˆ° (å”¯ä¸€è§£+è‰ç¨¿å€ç‰ˆ)</title>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700;900&family=Roboto+Mono:wght@500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f0f9ff; touch-action: manipulation; -webkit-tap-highlight-color: transparent; }
        .math-font { font-family: 'Roboto Mono', monospace; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        html { -webkit-text-size-adjust: 100%; }
        
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }

        /* --- æ–°å¢ï¼šç®—è‰å€æ¨£å¼ (ç”¨æˆ¶æŒ‡å®š) --- */
        .carry-input {
            width: 100%;
            height: 30px; /* è¼ƒçŸ® */
            text-align: center;
            font-size: 0.9rem;
            font-weight: bold;
            color: #ef4444; /* ç´…è‰²å­— */
            background-color: transparent;
            border: 2px dashed #fda4af; /* è™›ç·šæ¡†ï¼Œç¨å¾®åŠ ç²—ä»¥ä¾¿é»æ“Š */
            border-radius: 4px;
            outline: none;
        }
        .carry-input:focus {
            background-color: #fff1f2;
            border-color: #ef4444;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, memo } = React;

        const TOTAL_QUESTIONS = 10;

        // --- éŸ³æ•ˆåŠ©æ‰‹ ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        const playSound = (type) => {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const now = audioCtx.currentTime;
            
            if (type === 'success') {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.type = 'sine';
                osc.frequency.setValueAtTime(660, now); 
                osc.frequency.exponentialRampToValueAtTime(880, now + 0.1);
                gain.gain.setValueAtTime(0, now);
                gain.gain.linearRampToValueAtTime(0.3, now + 0.05);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                osc.start(now);
                osc.stop(now + 0.3);
            } else if (type === 'error') {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(220, now); 
                osc.frequency.linearRampToValueAtTime(150, now + 0.2);
                gain.gain.setValueAtTime(0, now);
                gain.gain.linearRampToValueAtTime(0.2, now + 0.05);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                osc.start(now);
                osc.stop(now + 0.3);
            } else if (type === 'win') {
                [523.25, 659.25, 783.99, 1046.50].forEach((freq, i) => {
                    const osc = audioCtx.createOscillator();
                    const gn = audioCtx.createGain();
                    osc.connect(gn);
                    gn.connect(audioCtx.destination);
                    osc.frequency.value = freq;
                    gn.gain.setValueAtTime(0.1, now + i*0.1);
                    gn.gain.exponentialRampToValueAtTime(0.001, now + i*0.1 + 1.5);
                    osc.start(now + i*0.1);
                    osc.stop(now + i*0.1 + 1.5);
                });
            }
        };

        const TimerDisplay = memo(({ startTime }) => {
            const [time, setTime] = useState(0);
            useEffect(() => {
                if (!startTime) return;
                const interval = setInterval(() => setTime(Math.floor((Date.now() - startTime) / 1000)), 1000);
                return () => clearInterval(interval);
            }, [startTime]);
            return <span className="font-mono text-slate-400 font-bold text-xl">{Math.floor(time / 60)}:{(time % 60).toString().padStart(2, '0')}</span>;
        });

        // --- è‰ç¨¿å€/é€²ä½æ ¼ ---
        const CarrySlot = () => {
            return (
                <div className="flex items-end justify-center pb-1">
                     <input type="tel" className="carry-input math-font" />
                </div>
            );
        };

        // --- æ•¸å­—æ ¼ ---
        const DigitSlot = ({ q, type, row, userInputs, mode, onInput }) => {
            const key = `${type}_${row}`;
            const isBlank = q.blanks.includes(key);
            const value = q.digits[key];

            // éš±è—å‰å°é›¶ (è¦–è¦ºå„ªåŒ–)
            if (value === 0 && row === 'h' && !isBlank) return <div className="w-10 h-14 md:w-12 md:h-16"></div>;
            if (value === 0 && row === 't' && q.digits[`${type}_h`] === 0 && !isBlank) return <div className="w-10 h-14 md:w-12 md:h-16"></div>;

            if (isBlank) {
                const inputValue = userInputs[key] || '';
                const isCorrect = inputValue === value.toString();
                const isLocked = mode === 'retry' && isCorrect;
                
                let borderClass = "border-blue-400 border-2 bg-white";
                if (mode === 'retry' && !isLocked) borderClass = "border-orange-400 border-4 bg-orange-50 animate-pulse"; 
                if (isLocked) borderClass = "border-green-500 bg-green-50 text-green-600 border-2";

                return (
                    <input 
                        type="tel" 
                        value={inputValue}
                        readOnly={isLocked}
                        onChange={(e) => onInput(key, e.target.value)}
                        className={`w-10 h-14 md:w-12 md:h-16 text-center text-2xl md:text-3xl font-bold rounded-lg shadow-inner outline-none transition-all math-font ${borderClass}`}
                    />
                );
            } else {
                return (
                    <div className="w-10 h-14 md:w-12 md:h-16 flex items-center justify-center text-3xl md:text-4xl font-black text-slate-700 math-font">
                        {value}
                    </div>
                );
            }
        };

        // --- å•é¡Œå¡ç‰‡ ---
        const QuestionCard = ({ q, index, userInputs, mode, feedback, onInput, onSubmit, startTime }) => {
            if (!q) return null;

            return (
                <div className="bg-white p-4 md:p-8 rounded-[2rem] shadow-xl border border-slate-200 max-w-lg mx-auto fade-in">
                    <div className="flex justify-between items-center mb-6 border-b pb-4">
                        <span className="bg-indigo-100 text-indigo-700 px-4 py-1 rounded-full text-sm font-bold">
                            Question {index + 1} / {TOTAL_QUESTIONS}
                        </span>
                        <TimerDisplay startTime={startTime} />
                    </div>

                    <div className="flex flex-col items-center">
                        {/* Grid çµæ§‹ï¼šæ–°å¢æœ€ä¸Šå±¤çš„ç®—è‰å€ */}
                        <div className="grid grid-cols-[1.5rem_3rem_3rem_3rem] md:grid-cols-[2rem_3.5rem_3.5rem_3.5rem] gap-y-1 gap-x-1 items-center justify-center">
                            
                            {/* --- Row 0: ç®—è‰å€ (Carry/Drafting) --- */}
                            <div></div> {/* ç¬¦è™Ÿæ¬„ç©ºç™½ */}
                            <CarrySlot />
                            <CarrySlot />
                            <CarrySlot />

                            {/* --- Row 1: N1 --- */}
                            <div></div>
                            <DigitSlot q={q} type="n1" row="h" userInputs={userInputs} mode={mode} onInput={onInput} />
                            <DigitSlot q={q} type="n1" row="t" userInputs={userInputs} mode={mode} onInput={onInput} />
                            <DigitSlot q={q} type="n1" row="o" userInputs={userInputs} mode={mode} onInput={onInput} />

                            {/* --- Row 2: Op1 N2 --- */}
                            <div className="text-2xl md:text-3xl font-bold text-slate-400 text-center">{q.op1 === '*' ? 'Ã—' : q.op1}</div>
                            <DigitSlot q={q} type="n2" row="h" userInputs={userInputs} mode={mode} onInput={onInput} />
                            <DigitSlot q={q} type="n2" row="t" userInputs={userInputs} mode={mode} onInput={onInput} />
                            <DigitSlot q={q} type="n2" row="o" userInputs={userInputs} mode={mode} onInput={onInput} />

                            {/* Line 1 */}
                            <div className="col-span-4 h-1 bg-slate-800 rounded-full my-1"></div>

                            {/* --- Row 3: R1 --- */}
                            <div></div>
                            <DigitSlot q={q} type="r1" row="h" userInputs={userInputs} mode={mode} onInput={onInput} />
                            <DigitSlot q={q} type="r1" row="t" userInputs={userInputs} mode={mode} onInput={onInput} />
                            <DigitSlot q={q} type="r1" row="o" userInputs={userInputs} mode={mode} onInput={onInput} />

                            {/* --- Row 4: Op2 N3 --- */}
                            <div className="text-2xl md:text-3xl font-bold text-slate-400 text-center">{q.op2 === '*' ? 'Ã—' : q.op2}</div>
                            <DigitSlot q={q} type="n3" row="h" userInputs={userInputs} mode={mode} onInput={onInput} />
                            <DigitSlot q={q} type="n3" row="t" userInputs={userInputs} mode={mode} onInput={onInput} />
                            <DigitSlot q={q} type="n3" row="o" userInputs={userInputs} mode={mode} onInput={onInput} />

                            {/* Line 2 */}
                            <div className="col-span-4 h-1 bg-slate-800 rounded-full my-1"></div>

                            {/* --- Row 5: R2 --- */}
                            <div></div>
                            <DigitSlot q={q} type="r2" row="h" userInputs={userInputs} mode={mode} onInput={onInput} />
                            <DigitSlot q={q} type="r2" row="t" userInputs={userInputs} mode={mode} onInput={onInput} />
                            <DigitSlot q={q} type="r2" row="o" userInputs={userInputs} mode={mode} onInput={onInput} />
                        </div>
                    </div>

                    <div className="mt-6 min-h-[3rem]">
                        {feedback && (
                            <div className={`p-3 rounded-xl text-center font-bold text-base md:text-lg animate-bounce ${feedback.type === 'success' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-600'}`}>
                                {feedback.msg}
                            </div>
                        )}
                    </div>

                    {mode === 'normal' && (
                        <button 
                            onClick={onSubmit}
                            className="w-full bg-indigo-600 hover:bg-indigo-700 text-white text-xl md:text-2xl font-black py-4 rounded-2xl shadow-lg transition-all active:scale-95 mt-4"
                        >
                            æäº¤ Check
                        </button>
                    )}
                    {mode === 'retry' && (
                        <div className="text-center text-slate-400 text-sm font-bold mt-4">
                            è¨‚æ­£æ¨¡å¼ï¼šè«‹å¡«å¯«é–ƒçˆçš„æ ¼å­
                        </div>
                    )}
                </div>
            );
        };

        const ReportCard = ({ history, totalTime, onRestart }) => {
            const wrongQuestions = history.filter(h => !h.passedFirstTry);
            const score = Math.round(((TOTAL_QUESTIONS - wrongQuestions.length) / TOTAL_QUESTIONS) * 100);

            useEffect(() => {
                if (score >= 80) {
                    playSound('win');
                    const duration = 3 * 1000;
                    const animationEnd = Date.now() + duration;
                    const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };
                    function randomInRange(min, max) { return Math.random() * (max - min) + min; }
                    const interval = setInterval(function() {
                        const timeLeft = animationEnd - Date.now();
                        if (timeLeft <= 0) return clearInterval(interval);
                        const particleCount = 50 * (timeLeft / duration);
                        confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } });
                        confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } });
                    }, 250);
                }
            }, [score]);

            return (
                <div className="bg-white p-8 rounded-[3rem] shadow-2xl max-w-2xl mx-auto text-center fade-in relative z-10 border border-indigo-50">
                    <h2 className="text-4xl font-black text-slate-800 mb-6">ä»»å‹™å®Œæˆï¼</h2>
                    <div className="flex justify-center gap-6 mb-10">
                        <div className="bg-blue-50 p-6 rounded-2xl flex-1">
                            <p className="text-xs text-blue-400 font-bold uppercase tracking-wider">Time</p>
                            <p className="text-3xl font-black text-blue-900">{totalTime}s</p>
                        </div>
                        <div className="bg-indigo-50 p-6 rounded-2xl flex-1">
                            <p className="text-xs text-indigo-400 font-bold uppercase tracking-wider">Score</p>
                            <p className={`text-4xl font-black ${score === 100 ? 'text-indigo-600 animate-pulse' : 'text-indigo-900'}`}>{score}</p>
                        </div>
                    </div>
                    <div className="text-left mb-10">
                        <h3 className="text-xl font-bold text-slate-700 mb-4 border-b pb-2">éŒ¯é¡Œåˆ†æï¼š</h3>
                        {wrongQuestions.length === 0 ? (
                            <div className="text-green-600 font-black text-xl text-center py-8 bg-green-50 rounded-2xl border-2 border-dashed border-green-300">
                                ğŸ† å®Œç¾ï¼Jasper å¤ªå¼·äº†ï¼
                            </div>
                        ) : (
                            <ul className="space-y-4 max-h-64 overflow-y-auto custom-scrollbar pr-2">
                                {wrongQuestions.map((q, i) => (
                                    <li key={i} className="bg-red-50 p-4 rounded-xl border border-red-100">
                                        <div className="font-bold text-red-800 mb-1">Question {q.id + 1}:</div>
                                        <div className="font-mono text-slate-600 text-lg">
                                            {q.n1} {q.op1 === '*' ? 'Ã—' : q.op1} {q.n2} = {q.r1} <br/>
                                            {q.r1} {q.op2 === '*' ? 'Ã—' : q.op2} {q.n3} = {q.r2}
                                        </div>
                                    </li>
                                ))}
                            </ul>
                        )}
                    </div>
                    <button onClick={onRestart} className="bg-slate-900 text-white px-8 py-4 rounded-2xl font-black text-xl hover:bg-slate-800 w-full active:scale-95 transition-all shadow-xl">
                        å†ç©ä¸€æ¬¡ (Play Again)
                    </button>
                </div>
            );
        };

        const App = () => {
            const [step, setStep] = useState('menu');
            const [qIndex, setQIndex] = useState(0);
            const [questions, setQuestions] = useState([]);
            const [userInputs, setUserInputs] = useState({});
            const [mode, setMode] = useState('normal'); 
            const [feedback, setFeedback] = useState(null);
            const [history, setHistory] = useState([]);
            const [startTime, setStartTime] = useState(null);
            const [finalTime, setFinalTime] = useState(0);

            // *** æ ¸å¿ƒé‚è¼¯ä¿®æ­£ï¼šå”¯ä¸€è§£ç”Ÿæˆå™¨ ***
            const generateQuestions = useCallback(() => {
                let newQs = [];
                for(let i=0; i<TOTAL_QUESTIONS; i++) {
                    let validPuzzle = false;
                    let puzzleData = null;
                    
                    while(!validPuzzle) {
                        let n1, n2, n3, r1, r2, op1, op2;
                        let validNums = false;
                        
                        // 1. ç”Ÿæˆæ•¸å­¸å¼
                        while(!validNums) {
                            op1 = ['+', '-', '*'][Math.floor(Math.random() * 3)];
                            if (op1 === '*') {
                                n1 = Math.floor(Math.random() * 80) + 10; 
                                n2 = Math.floor(Math.random() * 8) + 2;   
                                r1 = n1 * n2;
                            } else {
                                n1 = Math.floor(Math.random() * 89) + 10;
                                n2 = Math.floor(Math.random() * 89) + 10;
                                r1 = op1 === '+' ? n1 + n2 : n1 - n2;
                            }
                            if (r1 > 999 || r1 < 10) continue;

                            op2 = ['+', '-', '*'][Math.floor(Math.random() * 3)];
                            if (op2 === '*') {
                                if (r1 > 100) { 
                                    op2 = '-'; 
                                    n3 = Math.floor(Math.random() * (r1 - 10)) + 5;
                                    r2 = r1 - n3;
                                } else {
                                    n3 = Math.floor(Math.random() * 8) + 2; 
                                    r2 = r1 * n3;
                                }
                            } else {
                                n3 = Math.floor(Math.random() * 89) + 10;
                                r2 = op2 === '+' ? r1 + n3 : r1 - n3;
                            }
                            if (r2 > 0 && r2 < 1000) validNums = true; 
                        }

                        // 2. æ‹†åˆ†ä½æ•¸
                        const getDigits = (n) => ({ h: Math.floor(n / 100), t: Math.floor((n % 100) / 10), o: n % 10 });
                        const d_n1 = getDigits(n1); const d_n2 = getDigits(n2); const d_r1 = getDigits(r1);
                        const d_n3 = getDigits(n3); const d_r2 = getDigits(r2);

                        const digits = {
                            'n1_h': d_n1.h, 'n1_t': d_n1.t, 'n1_o': d_n1.o,
                            'n2_h': d_n2.h, 'n2_t': d_n2.t, 'n2_o': d_n2.o,
                            'r1_h': d_r1.h, 'r1_t': d_r1.t, 'r1_o': d_r1.o,
                            'n3_h': d_n3.h, 'n3_t': d_n3.t, 'n3_o': d_n3.o,
                            'r2_h': d_r2.h, 'r2_t': d_r2.t, 'r2_o': d_r2.o,
                        };

                        // 3. æŒ–ç©ºèˆ‡å”¯ä¸€è§£æª¢æŸ¥ (é—œéµä¿®æ­£)
                        const allKeys = Object.keys(digits).filter(k => {
                            // ä¸æŒ–å‰å°é›¶
                            if (k.endsWith('_h') && digits[k] === 0) return false;
                            if (k.endsWith('_t') && digits[k.replace('_t', '_h')] === 0 && digits[k] === 0) return false;
                            return true;
                        });

                        const shuffledKeys = allKeys.sort(() => 0.5 - Math.random());
                        let currentBlanks = [];
                        
                        // å®šç¾©äº’æ–¥çµ„ï¼šåŒä¸€è¡Œé‹ç®—æ•¸ä¸å¯åŒæ™‚æŒ–ç©º (ä¾‹å¦‚ n1_o å’Œ n2_o ä¸èƒ½åŒæ™‚ç‚ºç©º)
                        const conflictPairs = [
                            ['n1_o', 'n2_o'], ['n1_t', 'n2_t'], ['n1_h', 'n2_h'], // Step 1 Conflicts
                            ['r1_o', 'n3_o'], ['r1_t', 'n3_t'], ['r1_h', 'n3_h']  // Step 2 Conflicts
                        ];

                        for (let key of shuffledKeys) {
                            // æª¢æŸ¥æ˜¯å¦æœƒé€ æˆäº’æ–¥
                            let isConflict = false;
                            
                            // é è¨­å°‡æ­¤ key åŠ å…¥æ¸¬è©¦
                            const testBlanks = [...currentBlanks, key];
                            
                            for (let pair of conflictPairs) {
                                // å¦‚æœé€™ä¸€å°éƒ½åœ¨ç›®å‰çš„æŒ–ç©ºåå–®ä¸­ï¼Œå‰‡ç”¢ç”Ÿè¡çª (ç„¡é™å¤šè§£)
                                if (testBlanks.includes(pair[0]) && testBlanks.includes(pair[1])) {
                                    isConflict = true;
                                    break;
                                }
                            }

                            if (!isConflict) {
                                currentBlanks.push(key);
                            }
                            
                            if (currentBlanks.length >= 4) break;
                        }

                        if (currentBlanks.length >= 2) {
                            validPuzzle = true;
                            puzzleData = { id: i, n1, n2, n3, r1, r2, op1, op2, digits, blanks: currentBlanks };
                        }
                    }
                    newQs.push(puzzleData);
                }
                return newQs;
            }, []);

            const startQuiz = () => {
                if (audioCtx.state === 'suspended') audioCtx.resume();
                setQuestions(generateQuestions());
                setQIndex(0);
                setHistory([]);
                setUserInputs({});
                setMode('normal');
                setFeedback(null);
                setStep('quiz');
                setStartTime(Date.now());
            };

            const handleInput = (key, val) => {
                const num = val.slice(-1).replace(/[^0-9]/g, '');
                
                if (mode === 'normal') {
                    setUserInputs(prev => ({ ...prev, [key]: num }));
                } else if (mode === 'retry') {
                    const currentQ = questions[qIndex];
                    const correctVal = currentQ.digits[key].toString();
                    if (num === correctVal) {
                        playSound('success');
                        setUserInputs(prev => ({ ...prev, [key]: num }));
                        setFeedback({ type: 'success', msg: 'Correct! Next one.' });
                        const remaining = currentQ.blanks.filter(b => b !== key && userInputs[b] !== currentQ.digits[b].toString());
                        if (remaining.length === 0) setTimeout(() => nextQuestion(), 500);
                    } else {
                        playSound('error');
                        setFeedback({ type: 'error', msg: `Oops! Try again.` });
                    }
                }
            };

            const submitNormal = () => {
                const currentQ = questions[qIndex];
                const allFilled = currentQ.blanks.every(key => userInputs[key] && userInputs[key].length > 0);
                if (!allFilled) {
                    setFeedback({ type: 'error', msg: 'è«‹å¡«æ»¿æ‰€æœ‰æ ¼å­ (Fill all boxes)!' });
                    playSound('error');
                    return;
                }
                let allCorrect = true;
                currentQ.blanks.forEach(key => { if (userInputs[key] !== currentQ.digits[key].toString()) allCorrect = false; });
                if (allCorrect) {
                    playSound('success');
                    setHistory([...history, { ...currentQ, passedFirstTry: true }]);
                    nextQuestion();
                } else {
                    playSound('error');
                    setMode('retry');
                    setUserInputs({});
                    setFeedback({ type: 'error', msg: 'Calculation error. Let\'s fix it!' });
                    let newHistory = [...history];
                    if (!newHistory.find(h => h.id === currentQ.id)) newHistory.push({ ...currentQ, passedFirstTry: false });
                    setHistory(newHistory);
                }
            };

            const nextQuestion = () => {
                if (qIndex < TOTAL_QUESTIONS - 1) {
                    setQIndex(prev => prev + 1);
                    setUserInputs({});
                    setMode('normal');
                    setFeedback(null);
                } else {
                    setFinalTime(Math.floor((Date.now() - startTime) / 1000));
                    setStep('report');
                }
            };

            return (
                <div className="min-h-screen p-2 md:p-6 flex items-center justify-center bg-[#f0f9ff]">
                    {step === 'menu' && (
                        <div className="text-center bg-white p-10 rounded-[2.5rem] shadow-xl max-w-lg w-full fade-in border-4 border-white ring-4 ring-indigo-50">
                            <div className="text-6xl mb-4">ğŸš€</div>
                            <h1 className="text-3xl md:text-4xl font-black text-slate-800 mb-2">Jasper P3 Challenge</h1>
                            <p className="text-slate-500 mb-8 font-bold text-lg">å”¯ä¸€è§£é©—è­‰ + è‰ç¨¿å€å‡ç´šç‰ˆ</p>
                            <button onClick={startQuiz} className="w-full bg-indigo-600 text-white py-5 rounded-2xl text-2xl font-black shadow-lg hover:bg-indigo-700 active:scale-95 transition-all">
                                Start Game
                            </button>
                        </div>
                    )}
                    {step === 'quiz' && (
                        <QuestionCard 
                            q={questions[qIndex]} 
                            index={qIndex}
                            userInputs={userInputs}
                            mode={mode}
                            feedback={feedback}
                            onInput={handleInput}
                            onSubmit={submitNormal}
                            startTime={startTime}
                        />
                    )}
                    {step === 'report' && <ReportCard history={history} totalTime={finalTime} onRestart={() => setStep('menu')} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
